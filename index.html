<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Us ‚Äî Journey</title>
<meta name="theme-color" content="#ffffff" />
<style>
  :root{
    --bg:#f9fafc; --card:#ffffff; --ink:#182033; --muted:#77819b; --line:#e9edf6;
    --brand:#6ee7b7; --brand2:#93c5fd; --coral:#ffb4a8; --lilac:#c7b4ff; --gold:#f8d26a;
    --ok:#4ad69a; --warn:#f7b267; --bad:#ff7b7b;
    --r:16px; --shadow:0 8px 24px rgba(0,0,0,.06); --bar:64px; --fab:64px;
  }
  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
  html,body{height:100%}
  body{
    margin:0; color:var(--ink); background:var(--bg);
    font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
  }
  /* top */
  .top{position:sticky;top:0;z-index:10;display:flex;align-items:center;justify-content:space-between;gap:8px;
    padding:12px 14px;background:linear-gradient(180deg,#fff,#ffffffcc);border-bottom:1px solid var(--line);backdrop-filter:blur(6px)}
  .brand{display:flex;gap:10px;align-items:center}
  .logo{width:34px;height:34px;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand2))}
  h1{margin:0;font-size:18px}
  .muted{color:var(--muted);font-size:12px}
  .btn{appearance:none;border:1px solid var(--line);background:#fff;color:var(--ink);border-radius:999px;padding:10px 14px;font-weight:700}
  .btn.ghost{background:#fff}
  .btn.fill{background:linear-gradient(135deg,var(--brand),var(--brand2));color:#053}
  .chip{border:1px solid var(--line);border-radius:999px;padding:6px 10px;font-size:12px;background:#fff}

  /* content */
  .wrap{padding:12px 12px calc(var(--bar)+24px)}
  .card{background:var(--card);border:1px solid var(--line);border-radius:var(--r);box-shadow:var(--shadow);padding:12px;margin-bottom:12px}
  .title{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  input,select,textarea{width:100%;background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px;font-size:16px;outline:none}
  textarea{min-height:90px;resize:vertical}
  .empty{color:#8fa0bd;text-align:center;padding:16px}

  /* journey dots */
  .journey{display:flex;gap:10px;overflow:auto;padding:4px}
  .step{min-width:120px;background:#fff;border:1px solid var(--line);border-radius:14px;padding:10px;text-align:center}
  .step.locked{opacity:.55}
  .step .lvl{font-weight:900}
  .step .xp{font-size:12px;color:#5a6b8c}
  .badge{display:inline-block;padding:6px 10px;border-radius:999px;font-size:12px;background:#eef6ff;border:1px solid var(--line)}

  /* feed / list */
  .item{display:flex;gap:10px;padding:12px;border-radius:12px;background:#fff;border:1px solid var(--line)}
  .dot{width:10px;height:10px;border-radius:50%}
  .type-app .dot{background:var(--ok)}
  .type-wish .dot{background:var(--coral)}
  .type-debate .dot{background:var(--lilac)}
  .meta{color:#7b88a6;font-size:12px;margin-top:6px}

  /* bottom nav */
  .nav{position:fixed;bottom:0;inset-inline:0;height:var(--bar);display:flex;justify-content:space-around;align-items:center;
    background:#fff;border-top:1px solid var(--line);z-index:20}
  .tab{flex:1;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;color:#6a7696;font-size:11px}
  .tab.active{color:#1a1d2b;font-weight:800}
  .ico{font-size:20px;line-height:1}

  /* fab */
  .fab{position:fixed;right:16px;bottom:calc(var(--bar)+16px);width:var(--fab);height:var(--fab);border-radius:50%;
    background:linear-gradient(135deg,var(--brand),var(--brand2));color:#063;border:none;font-size:30px;font-weight:900;box-shadow:0 12px 28px rgba(0,0,0,.18)}

  /* sheet */
  .backdrop{position:fixed;inset:0;display:none;background:rgba(0,0,0,.2);backdrop-filter:blur(6px);align-items:flex-end;z-index:30}
  .sheet{width:100%;border-top-left-radius:18px;border-top-right-radius:18px;background:#fff;border-top:1px solid var(--line);padding:14px 12px 18px}
  .show{display:flex}

  /* toast */
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:calc(var(--bar)+var(--fab)+12px);background:#fff;border:1px solid var(--line);
    color:#173; padding:10px 14px;border-radius:999px;display:none;z-index:40;box-shadow:var(--shadow)}
  .toast.show{display:block}
</style>
</head>
<body>
  <div class="top">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>Us ‚Äî Journey</h1>
        <div class="muted" id="status">Demo ‚Ä¢ light</div>
      </div>
    </div>
    <div class="row">
      <button class="btn ghost" id="settingsBtn">‚öôÔ∏è</button>
    </div>
  </div>

  <main class="wrap">
    <!-- Journey -->
    <section id="screen-journey">
      <div class="card">
        <div class="title">
          <strong>Journey</strong>
          <span class="badge" id="xpBadge">XP 0 ‚Ä¢ Streak 0üî•</span>
        </div>
        <div class="journey" id="journeyStrip"></div>
      </div>

      <div class="card">
        <div class="title">
          <strong>Activity feed</strong>
          <span class="chip">+1 app ‚Ä¢ +2 wish ‚Ä¢ +3 win</span>
        </div>
        <div id="feed"><div class="empty">No activity yet. Tap <b>Ôºã</b> to start a challenge.</div></div>
      </div>
    </section>

    <!-- Daily Challenge -->
    <section id="screen-daily" style="display:none">
      <div class="card">
        <div class="title"><strong>Daily Challenge</strong><span class="chip" id="dailyChip"></span></div>
        <div class="item" style="align-items:flex-start">
          <div class="dot" style="background:var(--gold)"></div>
          <div style="flex:1">
            <div id="dailyText">Loading‚Ä¶</div>
            <div class="meta" id="dailyMeta"></div>
          </div>
          <button class="btn fill" id="completeDaily">Complete</button>
        </div>
      </div>

      <div class="card">
        <div class="title"><strong>Quick Add</strong><span class="chip">tiny is best</span></div>
        <div class="row"><input id="quickApp" placeholder="üíö 1-line appreciation"/></div>
        <div class="row"><input id="quickWish" placeholder="üß∏ 1-line gentle wish"/></div>
        <div class="row"><button class="btn fill" id="saveQuick">Save</button></div>
      </div>
    </section>

    <!-- Debates -->
    <section id="screen-debates" style="display:none">
      <div class="card">
        <div class="title"><strong>Today‚Äôs Debate</strong><span class="chip">fair & kind</span></div>
        <div class="row"><input id="debTitle" placeholder="Problem title (short)"/></div>
        <div class="row"><textarea id="debMine" placeholder="My view (any language)"></textarea></div>
        <div class="row"><textarea id="debPartner" placeholder="Partner‚Äôs view (any language)"></textarea></div>
        <div class="row">
          <select id="debLang">
            <option value="auto">Referee in partner‚Äôs language (auto UK/PT/EN)</option>
            <option value="uk">Ukrainian</option>
            <option value="pt">Portuguese</option>
            <option value="en">English</option>
          </select>
          <button class="btn" id="refereeBtn">Referee</button>
        </div>
        <div id="refereeCard" class="item" style="display:none">
          <div class="dot" style="background:var(--lilac)"></div>
          <div style="flex:1">
            <div id="refereeText"></div>
            <div class="meta" id="refereeMeta"></div>
          </div>
          <button class="btn fill" id="saveDebate">Post</button>
        </div>
      </div>

      <div class="card">
        <div class="title"><strong>Debate Board</strong><span class="chip">vote follow-through</span></div>
        <div id="debateList"><div class="empty">No debates yet.</div></div>
      </div>
    </section>

    <!-- Scores -->
    <section id="screen-scores" style="display:none">
      <div class="card">
        <div class="title"><strong>Leaderboard</strong><span class="chip">friendly only üòÑ</span></div>
        <div class="item"><div class="dot" style="background:var(--ok)"></div><div style="flex:1"><strong id="meName">You</strong><div class="meta"><span id="meXP">0</span> XP</div></div></div>
        <div class="item" style="margin-top:8px"><div class="dot" style="background:var(--brand2)"></div><div style="flex:1"><strong id="ptName">Partner</strong><div class="meta"><span id="ptXP">0</span> XP</div></div></div>
      </div>

      <div class="card">
        <div class="title"><strong>Goals</strong><span class="chip">unlock levels</span></div>
        <div class="item"><div class="dot" style="background:var(--gold)"></div><div>Streak <b id="streakN">0</b> days ‚Ä¢ Next: keep 3-day streak for <b>Level 2</b></div></div>
      </div>
    </section>
  </main>

  <!-- bottom nav -->
  <nav class="nav">
    <button class="tab active" data-scr="journey"><div class="ico">üó∫Ô∏è</div>Journey</button>
    <button class="tab" data-scr="daily"><div class="ico">‚≠ê</div>Daily</button>
    <button class="tab" data-scr="debates"><div class="ico">‚öñÔ∏è</div>Debates</button>
    <button class="tab" data-scr="scores"><div class="ico">üèÜ</div>Scores</button>
  </nav>

  <!-- fab -->
  <button class="fab" id="fab" aria-label="Add">Ôºã</button>

  <!-- add sheet -->
  <div class="backdrop" id="sheet">
    <div class="sheet">
      <div class="row" style="justify-content:space-between"><strong>Add</strong><button class="btn" id="closeSheet">Close</button></div>
      <div class="row" style="margin-top:10px">
        <button class="btn" id="addApp">üíö Appreciation</button>
        <button class="btn" id="addWish">üß∏ Wish</button>
        <button class="btn" id="addDeb">‚öñÔ∏è Debate</button>
      </div>
      <div id="form" style="margin-top:10px"></div>
      <div class="row" style="margin-top:10px"><button class="btn fill" id="saveBtn" style="display:none">Save</button></div>
    </div>
  </div>

  <div class="toast" id="toast">Saved</div>

<script>
/* ===== simple demo store (no backend) ===== */
const store = {
  xp: { me:0, partner:0 }, streak: 0,
  steps: Array.from({length:8}).map((_,i)=>({lvl:i+1, need: i*20, unlocked: i===0})),
  feed: [],             // {kind, who, text, when}
  dailyIndex: 0,
  debates: []           // {id,title,mine,partner,summary,lang,doneBy:'me'|'partner'|null}
};

/* ===== ui helpers ===== */
const $ = id=>document.getElementById(id);
const tabs = document.querySelectorAll('.tab');
tabs.forEach(b=>b.addEventListener('click', ()=>{
  tabs.forEach(x=>x.classList.remove('active')); b.classList.add('active');
  const scr=b.dataset.scr;
  ['journey','daily','debates','scores'].forEach(k=> document.getElementById('screen-'+k).style.display = (k===scr)?'block':'none');
}));

function toast(msg='Saved'){ const t=$('toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1200); }

function addXP(who, amount){
  store.xp[who]+=amount;
  $('meXP').textContent = store.xp.me;
  $('ptXP').textContent = store.xp.partner;
  const total = store.xp.me + store.xp.partner;
  const lvl = store.steps.findLast(s=> total >= s.need) || store.steps[0];
  store.steps.forEach(s=> s.unlocked = total >= s.need);
  renderJourney();
  renderBadges();
}

function renderJourney(){
  const strip=$('journeyStrip'); strip.innerHTML='';
  store.steps.forEach(s=>{
    const div=document.createElement('div');
    div.className='step'+(s.unlocked?'':' locked');
    div.innerHTML=`<div class="lvl">Level ${s.lvl}</div><div class="xp">${s.need} XP</div>`;
    strip.appendChild(div);
  });
}

function renderBadges(){
  $('xpBadge').textContent = `XP ${store.xp.me + store.xp.partner} ‚Ä¢ Streak ${store.streak}üî•`;
}

function addFeed(kind, who, text){
  store.feed.unshift({kind, who, text, when: new Date()});
  renderFeed();
}

function renderFeed(){
  const feed=$('feed');
  if(!store.feed.length){ feed.innerHTML='<div class="empty">No activity yet. Tap <b>Ôºã</b> to start a challenge.</div>'; return; }
  feed.innerHTML='';
  store.feed.forEach(it=>{
    const li=document.createElement('div');
    li.className='item type-'+(it.kind==='appreciation'?'app':'wish');
    if(it.kind==='summary' || it.kind==='debate') li.className='item type-debate';
    const when = new Intl.DateTimeFormat(undefined,{hour:'2-digit',minute:'2-digit'}).format(it.when);
    li.innerHTML=`<div class="dot"></div><div style="flex:1"><div>${it.text}</div><div class="meta">‚Äî ${it.who} ‚Ä¢ ${when}</div></div>`;
    feed.appendChild(li);
  });
}

/* ===== daily challenge ===== */
const DAILIES = [
  "Send 1 concrete appreciation.",
  "Plan a 10-minute walk together.",
  "Use ‚ÄúI feel‚Ä¶ when‚Ä¶, I‚Äôd love if‚Ä¶‚Äù once today.",
  "Do a 5-minute tidy together.",
  "Share 1 small win from the day.",
  "Make tomorrow‚Äôs mini-plan (2 bullets).",
];
function renderDaily(){
  const i = store.dailyIndex % DAILIES.length;
  $('dailyText').textContent = DAILIES[i];
  $('dailyChip').textContent = `Challenge ${i+1}/${DAILIES.length}`;
  $('dailyMeta').textContent = 'Complete for +2 XP each';
}
$('completeDaily').addEventListener('click', ()=>{
  addXP('me',2); addXP('partner',2);
  store.streak += 1;
  addFeed('daily','Both', 'Completed daily challenge');
  store.dailyIndex++;
  renderDaily(); renderBadges(); toast('Daily complete +4 XP');
});
$('saveQuick').addEventListener('click', ()=>{
  const a=$('quickApp').value.trim(), w=$('quickWish').value.trim();
  if(a){ addFeed('appreciation','Me', a); addXP('me',1); $('quickApp').value=''; }
  if(w){ addFeed('wish','Me', w); addXP('me',2); $('quickWish').value=''; }
  toast('Saved');
});

/* ===== debates (referee) ===== */
function guessLang(t){
  if(/[\u0400-\u04FF]/.test(t)) return 'uk';
  const pt=[' que ',' n√£o ',' voc√™ ',' pra ',' de ',' √© ',' ao ',' √† ',' meu ',' minha ',' seu ',' sua ',' com '];
  const L=' '+t.toLowerCase()+' '; return pt.some(w=>L.includes(w))?'pt':'en';
}
function summarizeLocal(title, mine, partner, target){
  // Tiny, kind, neutral referee (2‚Äì3 lines)
  const templates={
    en: (t,m,p)=>`Referee (${t}): You both care. You said: ‚Äú${m.slice(0,80)}‚Ä¶‚Äù. Partner said: ‚Äú${p.slice(0,80)}‚Ä¶‚Äù. Tiny next step: pick one test for 48h and check in.`,
    pt: (t,m,p)=>`√Årbitro (${t}): Voc√™s se importam. Voc√™: ‚Äú${m.slice(0,80)}‚Ä¶‚Äù. Parceira(o): ‚Äú${p.slice(0,80)}‚Ä¶‚Äù. Passo pequeno: 1 teste por 48h e revisar.`,
    uk: (t,m,p)=>`–†–µ—Ñ–µ—Ä—ñ (${t}): –í–∞–º –æ–±–æ–º –Ω–µ –±–∞–π–¥—É–∂–µ. –í–∏: ¬´${m.slice(0,80)}‚Ä¶¬ª. –ü–∞—Ä—Ç–Ω–µ—Ä(–∫–∞): ¬´${p.slice(0,80)}‚Ä¶¬ª. –ú–∞–ª–∏–π –∫—Ä–æ–∫: 1 —Ç–µ—Å—Ç –Ω–∞ 48 –≥–æ–¥ —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞.`
  };
  return (templates[target]||templates.en)(title,mine,partner);
}
$('refereeBtn').addEventListener('click', ()=>{
  const title=$('debTitle').value.trim();
  const mine=$('debMine').value.trim();
  const partner=$('debPartner').value.trim();
  if(!title||!mine||!partner) return;
  const target = (()=>{
    const sel = $('debLang').value;
    if(sel!=='auto') return sel;
    // pick partner language from their text if present, else default uk
    const gl = guessLang(partner); return gl || 'uk';
  })();
  const out = summarizeLocal(title, mine, partner, target);
  $('refereeText').textContent = out;
  $('refereeMeta').textContent = `‚Üí ${target.toUpperCase()} ‚Ä¢ fair & short`;
  $('refereeCard').style.display='flex';
});
$('saveDebate').addEventListener('click', ()=>{
  const title=$('debTitle').value.trim();
  const sum=$('refereeText').textContent.trim();
  if(!title||!sum) return;
  const id = Math.random().toString(36).slice(2,9);
  store.debates.unshift({id,title,summary:sum,doneBy:null});
  renderDebates();
  addFeed('debate','Referee',`‚Äú${title}‚Äù ‚Üí plan posted`);
  toast('Debate posted (+1 XP each)'); addXP('me',1); addXP('partner',1);
  // reset form
  $('debTitle').value=''; $('debMine').value=''; $('debPartner').value=''; $('refereeCard').style.display='none';
});
function renderDebates(){
  const list=$('debateList'); if(!store.debates.length){ list.innerHTML='<div class="empty">No debates yet.</div>'; return; }
  list.innerHTML='';
  store.debates.forEach(d=>{
    const row=document.createElement('div'); row.className='item';
    row.innerHTML=`<div class="dot" style="background:${'#c7b4ff'}"></div>
      <div style="flex:1">
        <div><strong>${d.title}</strong></div>
        <div class="meta">${d.summary}</div>
        <div class="row" style="margin-top:8px">
          <button class="btn" data-who="me">‚úîÔ∏è I followed</button>
          <button class="btn" data-who="partner">‚úîÔ∏è Partner followed</button>
          <button class="btn" data-who="none">‚úñÔ∏è Skip</button>
        </div>
      </div>`;
    const btns = row.querySelectorAll('button');
    btns.forEach(b=> b.addEventListener('click', ()=>{
      const who=b.dataset.who;
      if(who==='me'){ addXP('me',3); addFeed('summary','Me',`Followed debate: ${d.title}`); }
      else if(who==='partner'){ addXP('partner',3); addFeed('summary','Partner',`Followed debate: ${d.title}`); }
      list.removeChild(row);
    }));
    list.appendChild(row);
  });
}

/* ===== add sheet ===== */
const sheet=$('sheet'), form=$('form');
$('fab').addEventListener('click', ()=>{ sheet.classList.add('show'); form.innerHTML=''; $('saveBtn').style.display='none'; });
$('closeSheet').addEventListener('click', ()=> sheet.classList.remove('show'));
$('addApp').addEventListener('click', ()=>{
  form.innerHTML = `<textarea id="t" placeholder="üíö 1-2 sentences‚Ä¶"></textarea>`; $('saveBtn').style.display='inline-block';
  $('saveBtn').onclick=()=>{ const v=$('t').value.trim(); if(!v) return; addFeed('appreciation','Me',v); addXP('me',1); sheet.classList.remove('show'); toast('Added'); };
});
$('addWish').addEventListener('click', ()=>{
  form.innerHTML = `<textarea id="t" placeholder="üß∏ I feel‚Ä¶ when‚Ä¶, I‚Äôd love if‚Ä¶"></textarea>`; $('saveBtn').style.display='inline-block';
  $('saveBtn').onclick=()=>{ const v=$('t').value.trim(); if(!v) return; addFeed('wish','Me',v); addXP('me',2); sheet.classList.remove('show'); toast('Added'); };
});
$('addDeb').addEventListener('click', ()=>{
  tabs.forEach(x=>x.classList.remove('active')); document.querySelector('[data-scr="debates"]').classList.add('active');
  ['journey','daily','scores'].forEach(k=> document.getElementById('screen-'+k).style.display='none');
  document.getElementById('screen-debates').style.display='block';
  sheet.classList.remove('show');
});

/* ===== settings (names only for demo) ===== */
$('settingsBtn').addEventListener('click', ()=>{
  const newMe = prompt('Your display name', $('meName').textContent || 'You') || 'You';
  const newPt = prompt('Partner display name', $('ptName').textContent || 'Partner') || 'Partner';
  $('meName').textContent = newMe; $('ptName').textContent = newPt;
  toast('Names saved');
});

/* ===== start ===== */
renderJourney(); renderBadges(); renderFeed(); renderDaily(); renderDebates();
</script>
</body>
</html>
